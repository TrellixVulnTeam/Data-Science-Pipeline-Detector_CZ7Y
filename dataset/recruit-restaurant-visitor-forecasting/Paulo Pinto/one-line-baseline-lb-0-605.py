import pandas as pd;pd.concat([pd.merge(pd.read_csv('../input/sample_submission.csv',usecols=[0],header=0, sep=',|_',engine='python',names=['date']).reset_index(), pd.read_csv('../input/air_visit_data.csv', usecols=[0,1,3],header=0,sep=',|_',engine='python' ).set_index(['air','store']).groupby(['air','store'] )['visit'].median().to_frame('visitors').fillna(1).reset_index(),how='left', left_on=['level_0','level_1'], right_on=['air','store']), pd.read_csv('../input/sample_submission.csv', usecols=[0])], 1)[['id','visitors']].to_csv('median.csv', index=False)