import pandas as pd;pd.read_csv("../input/test.csv", usecols=[0,2,3] ).set_index( ['item_nbr','store_nbr'] ).join( pd.read_csv('../input/train.csv', usecols=[0,2,3,4], converters={'unit_sales':lambda u: float(u) if float(u)>0 else 0}, skiprows=range(1,124035460) ).groupby( ['item_nbr','store_nbr'] )['unit_sales'].median().to_frame('unit_sales'), how='left').fillna(0).to_csv('median.csv', float_format='%.2f', index=None) #LB=0.650