import pandas as pd

df_test = pd.read_csv('../input/test.csv')

bool_test = (df_test == 0).astype(int)

df_test['coef_pos'] = bool_test['ind_var30'] * 1.45917 + bool_test['saldo_medio_var5_hace3'] * 1.35967 + bool_test['num_var45_hace2'] * 0.350629 + bool_test['ind_var13'] * 1.84982 + bool_test['saldo_medio_var5_hace2'] * 1.39326 + bool_test['saldo_medio_var5_ult1'] * 1.38327 + bool_test['num_meses_var5_ult3'] * 1.44207 + bool_test['ind_var24'] * 1.659 + bool_test['ind_var12_0'] * 1.21814 + bool_test['num_var45_ult1'] * 0.293493 + bool_test['saldo_var42'] * 1.36075 + bool_test['imp_aport_var13_hace3'] * 2.5268 + bool_test['ind_var5'] * 1.37902 + bool_test['ind_var39_0'] * 0.484142 + bool_test['imp_trans_var37_ult1'] * 0.316127 + bool_test['num_var4'] * 1.44985 + bool_test['ind_var41_0'] * 0.471561 + bool_test['num_meses_var13_largo_ult3'] * 2.78268 + bool_test['num_meses_var39_vig_ult3'] * 0.430891 + bool_test['num_med_var45_ult3'] * 0.217628 + bool_test['ind_var12'] * 1.48491 + bool_test['saldo_medio_var12_hace2'] * 1.53351 + bool_test['ind_var20_0'] * 2.03285 + bool_test['delta_imp_aport_var13_1y3'] * 2.0223 + bool_test['num_var42'] * 1.37967 + bool_test['saldo_medio_var17_hace2'] * 1.01487 + bool_test['saldo_medio_var44_hace2'] * 1.04433 + bool_test['ind_var13_corto'] * 1.68179 + bool_test['ind_var33_0'] * 0.523245 + bool_test['num_meses_var12_ult3'] * 1.40716 + bool_test['ind_var13_largo_0'] * 2.44101 + bool_test['saldo_medio_var13_corto_hace3'] * 2.28836 + bool_test['ind_var31_0'] * 0.827701 + bool_test['num_op_var39_ult3'] * 0.0553498 + bool_test['ind_var5_0'] * 0.681235 + bool_test['delta_imp_venta_var44_1y3'] * 0.176733 + bool_test['imp_aport_var13_ult1'] * 1.00938 + bool_test['num_op_var40_hace2'] * 1.10028 + bool_test['num_op_var41_ult3'] * 0.0510542 + bool_test['imp_var43_emit_ult1'] * 0.093198 + bool_test['num_var45_ult3'] * 0.181398 + bool_test['saldo_medio_var12_ult1'] * 1.44715 + bool_test['ind_var14_0'] * 0.95348 + bool_test['imp_op_var41_comer_ult3'] * 0.0376404 + bool_test['saldo_medio_var13_corto_hace2'] * 1.62129 + bool_test['num_trasp_var11_ult1'] * 0.453432 + bool_test['num_meses_var17_ult3'] * 0.547232 + bool_test['var3'] * 0.378169 + bool_test['saldo_medio_var17_ult1'] * 0.485766 + bool_test['delta_num_aport_var13_1y3'] * 2.01075 + bool_test['imp_op_var39_comer_ult1'] * 0.0538305 + bool_test['num_var37_med_ult2'] * 0.0442899 + bool_test['delta_num_compra_var44_1y3'] * 0.274907 + bool_test['delta_imp_compra_var44_1y3'] * 0.320775 + bool_test['imp_op_var39_comer_ult3'] * 0.0541735 + bool_test['ind_var17_0'] * 0.649192 + bool_test['saldo_medio_var12_hace3'] * 1.52867 + bool_test['ind_var13_largo'] * 2.4207

df_test['coef_neg'] = bool_test['ind_var8_0'] * -0.96604 + bool_test['imp_op_var40_efect_ult3'] * -2.34771 + bool_test['var36'] * -2.48097 + bool_test['num_var42_0'] * -1.89876 + bool_test['imp_sal_var16_ult1'] * -1.13002 + bool_test['ind_var10cte_ult1'] * -0.185145 + bool_test['ind_var9_ult1'] * -0.172415 + bool_test['num_var22_hace3'] * -0.106653 + bool_test['imp_op_var41_efect_ult1'] * -0.279952 + bool_test['ind_var40'] * -0.758287 + bool_test['num_var22_ult1'] * -0.0890593 + bool_test['ind_var32_cte'] * -0.589288 + bool_test['ind_var30_0'] * -1.64515 + bool_test['ind_var25_0'] * -0.589749 + bool_test['imp_ent_var16_ult1'] * -0.0922935 + bool_test['num_meses_var8_ult3'] * -0.74309 + bool_test['ind_var25_cte'] * -0.642692 + bool_test['imp_op_var39_efect_ult1'] * -0.277996 + bool_test['ind_var32_0'] * -0.378169 + bool_test['ind_var37_cte'] * -0.0636237 + bool_test['imp_op_var40_comer_ult3'] * -0.256795 + bool_test['num_med_var22_ult3'] * -0.0395607 + bool_test['imp_reemb_var17_ult1'] * -0.626402 + bool_test['ind_var1'] * -0.741967 + bool_test['ind_var26_0'] * -0.586447 + bool_test['ind_var26_cte'] * -0.645387 + bool_test['ind_var6_0'] * -1.58159 + bool_test['num_op_var40_ult3'] * -0.522252 + bool_test['saldo_medio_var8_hace2'] * -0.697995 + bool_test['saldo_medio_var8_hace3'] * -0.604754 + bool_test['ind_var37_0'] * -0.0755714 + bool_test['delta_imp_trasp_var17_in_1y3'] * -1.80476 + bool_test['imp_op_var40_ult1'] * -0.587406 + bool_test['imp_var7_recib_ult1'] * -0.181767 + bool_test['ind_var18_0'] * -2.49794 + bool_test['ind_var1_0'] * -0.1272 + bool_test['imp_op_var40_comer_ult1'] * -0.31745 + bool_test['imp_compra_var44_hace3'] * -0.0551857 + bool_test['delta_imp_trasp_var17_out_1y3'] * -1.80476 + bool_test['saldo_medio_var17_hace3'] * -0.482786 + bool_test['delta_imp_reemb_var17_1y3'] * -0.552275 + bool_test['ind_var34_0'] * -2.49794

df_test['coef_total'] = df_test['coef_pos'] + df_test['coef_neg']
coef_test = (df_test['coef_total'] + 14) / 51 # Normalise
id_test = df_test['ID']

submission = pd.DataFrame({"ID":id_test, "TARGET":coef_test})
submission.to_csv("submission.csv", index=False)